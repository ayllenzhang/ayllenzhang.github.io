<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="true/2019/07/mcmc-notes/">
    
    
    <title>Notes about MCMC and Sampling | Ayllen&#39;s Neverland</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Machine Learning,notes,MCMC">
    <meta name="description" content="It all starts with a question:  How to sample from a given distribution?">
<meta property="og:type" content="article">
<meta property="og:title" content="Notes about MCMC and Sampling">
<meta property="og:url" content="https://ayllenzhang.github.io/2019/07/mcmc-notes/index.html">
<meta property="og:site_name" content="Ayllen&#39;s Neverland">
<meta property="og:description" content="It all starts with a question:  How to sample from a given distribution?">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/06/19/j7xyLaiEI86NOe1.png">
<meta property="article:published_time" content="2019-07-26T11:43:46.000Z">
<meta property="article:modified_time" content="2021-06-19T17:54:14.888Z">
<meta property="article:author" content="Ayllen Zhang">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="notes">
<meta property="article:tag" content="MCMC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/19/j7xyLaiEI86NOe1.png">
    
        <link rel="alternate" type="application/atom+xml" title="Ayllen&#39;s Neverland" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/halfmoon.png">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <link rel="stylesheet" href="/css/prism/prism-tomorrow-night.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-list-ul"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/yapam.jpeg)">
      <div class="brand">
        <a href="/about" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/mokuroo.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Ayllen Zhang</h5>
          <a href="mailto:ayllenzhang@gmail.com" title="ayllenzhang@gmail.com" class="mail">ayllenzhang@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/ayllenzhang" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/u/1934790632" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a target="_blank" rel="noopener" href="http://roosephu.github.io"  >
                <i class="icon icon-lg icon-link"></i>
                AFAIK (Roosephu)
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a target="_blank" rel="noopener" href="http://jiaqiguan.net"  >
                <i class="icon icon-lg icon-link2"></i>
                Jiaqi&#39;s Homepage
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Notes about MCMC and Sampling</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Notes about MCMC and Sampling</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-07-26T11:43:46.000Z" itemprop="datePublished" class="page-time">
  7月 26, 2019
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Research/">科研 / Research</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#the-simplest-method"><span class="post-toc-text">The simplest method</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#some-other-methods"><span class="post-toc-text">Some other methods</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#rejection-sampling"><span class="post-toc-text">Rejection sampling</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#importance-sampling"><span class="post-toc-text">Importance Sampling</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#markov-chain-monte-carlo"><span class="post-toc-text">Markov chain Monte Carlo</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#markov-process"><span class="post-toc-text">Markov process</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#markov-chain"><span class="post-toc-text">Markov chain</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#detailed-balance-condition"><span class="post-toc-text">Detailed balance condition</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hidden-markov-model"><span class="post-toc-text">Hidden Markov Model</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#metropolishastings-algorithm"><span class="post-toc-text">Metropolis–Hastings algorithm</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gibbs-sampling"><span class="post-toc-text">Gibbs Sampling</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#slice-sampling"><span class="post-toc-text">Slice Sampling</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-mcmc-notes"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Notes about MCMC and Sampling</h1>
        <div class="post-meta">
            <time class="post-time" title="7月 26, 2019 19:43" datetime="2019-07-26T11:43:46.000Z"  itemprop="datePublished">7月 26, 2019</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Research/">科研 / Research</a></li></ul>



            

            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>It all starts with a question:</p>
<blockquote>
<p>How to sample from a given distribution?</p>
</blockquote>
<p><escape><span id="more"></span></escape></p>
<h1 id="the-simplest-method">The simplest method</h1>
<p>Let's say, how to sample from <span class="math inline">\(Uniform(0, 1)\)</span>?</p>
<p>Actually the <code>random()</code> function, which is a pseudo-random number generator, have already solved the problem for us. It can generate a sequence of numbers whose properties approximate the properties of sequences of random numbers obeying uniform distribution.</p>
<p>Moreover, we can sample from normal distribution by utilizing <em>Box-Muller</em> transform.</p>
<blockquote>
<p><strong>Box-Muller transform</strong></p>
<p>If random variables <span class="math inline">\(U_1, U_2 \overset{\text{iid}}{\sim} U(0,1)\)</span>, and</p>
<p><span class="math display">\[\begin{align} Z_1=\sqrt{-2\ln{U_1}}cos(2\pi U_2) \\ Z_2=\sqrt{-2\ln{U_1}}sin(2\pi U_2) \end{align}\]</span></p>
<p>then <span class="math inline">\(N_1, N_2 \overset{\text{iid}}{\sim} \mathcal{N}(0,1)\)</span></p>
</blockquote>
<p>Some other common continuous distribution e.g. exponential distribution, gamma distribution, beta distribution and t-distribution could also be sampling with similar math transform. However, when sampling from more complicated distributions or high dimensional distributions, it's not so easy to find such a transform. Here, complex sampling method will be used, and the algorithms we're going to introduce, MCMC(Markov Chain Monte Carlo) and Gibbs sampling are two of them that are commonly used.</p>
<h1 id="some-other-methods">Some other methods</h1>
<p>Before looking directly at our goals, I'd like to introduce some other sampling methods first.</p>
<h2 id="rejection-sampling">Rejection sampling</h2>
<p>Also called accept-reject method. Given a distribution with p.d.f. <span class="math inline">\(p(x)\)</span>. Suppose there is another simple distribution function <span class="math inline">\(q(x)\)</span> from which we can sample easily. If there exist a constant <span class="math inline">\(M&lt;\inf\)</span> that for all <span class="math inline">\(x\in\mathbb{R}\)</span>,</p>
<p><span class="math display">\[p(x)\leq Mq(x)\]</span></p>
<p>then we can sample from <span class="math inline">\(p(x)\)</span> with the following method:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="op">=</span> <span class="dv">1</span> to N:</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    Generate u <span class="op">~</span> U(<span class="dv">0</span>, <span class="dv">1</span>) <span class="kw">and</span> x <span class="op">~</span> q(x)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> u <span class="op">&lt;</span> p(x) <span class="op">/</span> (M <span class="op">*</span> q(x)):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        x <span class="kw">is</span> accepted <span class="im">as</span> a sample</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span></code></pre></div>
<p>It can be easily proved that this algorithm works.</p>
<h2 id="importance-sampling">Importance Sampling</h2>
<p>Say if we want to know the expectation of <span class="math inline">\(f(x)\)</span>, i.e. <span class="math inline">\(\operatorname{E}[f(x)]\)</span>, in which the random variable <span class="math inline">\(x\)</span> follows a distribution <span class="math inline">\(p(x)\)</span>. Also, consider another simple distribution function <span class="math inline">\(q(x)\)</span> that can be easily sampled. Then</p>
<p><span class="math display">\[ \hat{E}=\int_x{f(x)p(x)dx}=\int_x{f(x)\frac{p(x)}{q(x)}q(x)dx}\]</span></p>
<p>Let <span class="math inline">\(w(x)=\frac{p(x)}{q(x)}\)</span>, the last formula can be seen as <span class="math inline">\(\operatorname{E}[f(x)w(x)]\)</span> in which <span class="math inline">\(x\sim q(x)\)</span>. As we can easily sample from <span class="math inline">\(q(x)\)</span>,</p>
<p><span class="math display">\[\hat{E}=\frac{1}{N}\sum\limits_{i=1}^N{f(x^{(i)})w(x^{(i)})}\]</span></p>
<p>in which <span class="math inline">\(x^{(i)}\)</span> is the <span class="math inline">\(i\)</span>-th sampled <span class="math inline">\(x\)</span> from <span class="math inline">\(q(x)\)</span>. Here <span class="math inline">\(w(x)\)</span> is called <strong>importance weight</strong>.</p>
<h1 id="markov-chain-monte-carlo">Markov chain Monte Carlo</h1>
<p>MCMC methods comprise a class of algorithms for sampling from a probability distribution. bMarkov Process, Markov Chain &amp; Hidden Markov Model</p>
<h3 id="markov-process">Markov process</h3>
<p>Markov process is a stochastic <em>process</em> that satisfies the Markov property, i.e. the conditional probability distribution of future states of the process depends only upon the present state.</p>
<h3 id="markov-chain">Markov chain</h3>
<p>Markov chain is a stochastic <em>model</em> describing a sequence of possible events in which the probability of each event depends only on the state attained in the previous event.</p>
<p>For a Markov chain with finite state space, the transition probability distribution can be represented by a matrix, called the transition matrix, with the <span class="math inline">\((i, j)th\)</span> element of <span class="math inline">\(P\)</span> equals to <span class="math display">\[
p_{ij}=\Pr(X_{n+1}=j\mid X_{n}=i)
\]</span> A Markov chain is called time-homogeneous if the transition matrix <span class="math inline">\(P\)</span> is the same after each step.</p>
<p>If the Markov chain is irreducible and aperiodic, then there is a unique stationary distribution <strong>π</strong>. <span class="math display">\[
\pi\mathbf{P}=\pi
\]</span> There are three several important properties for those fully connected (namely for all <span class="math inline">\((i,j)\)</span> in <span class="math inline">\(P\)</span>, <span class="math inline">\(\exists n\in\mathbb{N^+} \text{ such that }P^n_{ij}\neq0\)</span>), aperiodic, time-homogeneous Markov chain.</p>
<ol type="1">
<li><p><span class="math display">\[
\begin{equation}
\lim_{n\rightarrow \infty}{P^n}=
\begin{bmatrix} \pi\\\pi\\\vdots\\\pi\\ \end{bmatrix}
= 
\begin{bmatrix}
\pi(1)&amp;\pi(2)&amp;\cdots&amp;\pi(j)&amp;\cdots\\
\pi(1)&amp;\pi(2)&amp;\cdots&amp;\pi(j)&amp;\cdots\\
\vdots&amp;\vdots&amp;\ddots&amp;\pi(j)&amp;\cdots\\
\pi(1)&amp;\pi(2)&amp;\cdots&amp;\pi(j)&amp;\cdots\\
\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\
\end{bmatrix}
\end{equation}
\]</span></p></li>
<li><p><span class="math display">\[
\pi(j)=\sum_{i=0}^{\infty}\pi(i)P_{ij}
\]</span></p></li>
<li><p><span class="math inline">\(\pi\)</span> is the only non-negative solution of equation <span class="math inline">\(\pi\mathbf{P}=\pi\)</span></p></li>
</ol>
<h3 id="detailed-balance-condition">Detailed balance condition</h3>
<p>A Markov chain is said to be reversible if there is a probability distribution <span class="math inline">\(\pi\)</span> over its states such that <span class="math display">\[
\pi _{i}\Pr(X_{n+1}=j\mid X_{n}=i)=\pi _{j}\Pr(X_{n+1}=i\mid X_{n}=j)
\]</span> the detailed balance equation can be written as <span class="math display">\[
\pi _{i}p_{ij}=\pi _{j}p_{ji}\,
\]</span></p>
<p>which indicates that, for each pair of states <span class="math inline">\((i, j)\)</span>, the probability mass gained from each other should be equal to the probability mass they loss at the same time, when the stationary distribution <span class="math inline">\(\pi\)</span> is reached.</p>
<h3 id="hidden-markov-model">Hidden Markov Model</h3>
<p>HMM is a statistical Markov model in which the system being modeled is assumed to be a Markov process with hidden states and visible output state for each hidden state. The following image describes a Markov chain. <span class="math inline">\(x(t-1)\)</span>, <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(x(t+1)\)</span> denote the hidden states at the 3 moment, while <span class="math inline">\(y(t-1)\)</span>, <span class="math inline">\(y(t)\)</span> and <span class="math inline">\(y(t+1)\)</span> denote the corresponding observer states.</p>
<figure>
<img src="https://i.loli.net/2021/06/19/j7xyLaiEI86NOe1.png" alt="HMM.png" /><figcaption aria-hidden="true">HMM.png</figcaption>
</figure>
<h2 id="metropolishastings-algorithm">Metropolis–Hastings algorithm</h2>
<p><strong>M-H algorithm</strong> is one of the commonly used random walk Monte Carlo methods. In fact, the name Monte Carlo is suggested to use by Metropolis. As said above, MCMC is to construct a Markov chain with stationary distribution <span class="math inline">\(\pi=p(x)\)</span>, in which <span class="math inline">\(p(x)\)</span> is the given distribution to be sampled.</p>
<p>Consider that we already know the given distribution <span class="math inline">\(p(x)\)</span> and its transition matrix <span class="math inline">\(Q\)</span>. Generally we'll have <span class="math display">\[
p(i)q(i,j)\neq p(j)q(j,i)
\]</span> We can introduce another coefficient <span class="math inline">\(\alpha(i,j)\)</span> that will hopefully solve the problem for us, namely <span class="math display">\[
\begin{equation}
p(i)q(i,j)\alpha(i,j)=p(j)q(j,i)\alpha(j,i) \tag{*}
\end{equation}
\]</span> Clearly we can let <span class="math inline">\(\alpha(i,j)=p(j)q(j,i)\)</span> to make the equation true. If we let <span class="math inline">\(q&#39;(i,j)=q(i,j)\alpha(i,j)\)</span>, the original equation would become: <span class="math display">\[
p(i)q&#39;(i,j)=p(j)q&#39;(j,i)
\]</span> Now we have successfully constructed a Markov chain with transition matrix <span class="math inline">\(q&#39;\)</span> and given stationary distribution <span class="math inline">\(p(x)\)</span>. The Metropolis–Hastings algorithm is described below. Notice that <span class="math inline">\(q(j|i) = q(i,j)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x_&#123;<span class="dv">0</span>&#125; <span class="op">=</span> x0 <span class="co"># Initialization</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="op">=</span> <span class="dv">1</span> to N:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    Generate x<span class="op">*</span> <span class="op">~</span> q(x<span class="op">*|</span>x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="bu">min</span>( <span class="dv">1</span>, ( p(x<span class="op">*</span>) <span class="op">*</span> q(x<span class="op">*|</span>x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;) ) <span class="op">/</span> ( p(x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;) <span class="op">*</span> q(x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;<span class="op">|</span>x<span class="op">*</span>) ) )</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    Generate u <span class="op">~</span> U(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> u <span class="op">&gt;</span> a:</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        x_&#123;i&#125; <span class="op">=</span> x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125; <span class="co"># Reject</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        x_&#123;i&#125; <span class="op">=</span> x<span class="op">*</span> <span class="co"># Accept</span></span></code></pre></div>
<p>When <span class="math inline">\(q(i, j)=q(j,i)\)</span> is satisfied, the algorithm is called <strong>Metropolis algorithm</strong>, in which</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="bu">min</span>( <span class="dv">1</span>, p(x<span class="op">*</span>) <span class="op">/</span> p(x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;) )</span></code></pre></div>
<h2 id="gibbs-sampling">Gibbs Sampling</h2>
<p><strong>Gibbs sampling</strong> is a special case of the <em>Metropolis–Hastings algorithm</em>. Given a multivariate distribution, it's better for us to use <em>Gibbs sampling</em> if it is simpler to sample from a conditional distribution than to marginalize by integrating over a joint distribution. Suppose we want to obtain <span class="math inline">\(N\)</span> samples of <span class="math inline">\(\mathbf {X}=(x_{1},\dots ,x_{n})\)</span> from a joint distribution <span class="math inline">\({\displaystyle p(x_{1},\dots ,x_{n})}\)</span>. <em>Gibbs sampling</em> can be described as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X_0 <span class="op">=</span> X0 <span class="co"># Initialization</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="op">=</span> <span class="dv">1</span> to N:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="dv">1</span> to n:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        sample x<span class="op">^</span>i_j <span class="im">from</span> the distribution:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            p(x<span class="op">^</span>i_j<span class="op">|</span>x<span class="op">^</span>i_1,...,x<span class="op">^</span>i_&#123;j<span class="op">-</span><span class="dv">1</span>&#125;,x<span class="op">^</span>&#123;i<span class="op">-</span><span class="dv">1</span>&#125;_&#123;j<span class="op">+</span><span class="dv">1</span>&#125;,...x<span class="op">^</span>&#123;i<span class="op">-</span><span class="dv">1</span>&#125;_n)</span></code></pre></div>
<h2 id="slice-sampling">Slice Sampling</h2>
<p>Suppose you want to sample some random variable <span class="math inline">\(X\)</span> with distribution <span class="math inline">\(f(x)\)</span>. <em>Slice sampling</em> can be described as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x_0 <span class="op">=</span> x0 <span class="co"># Initialization</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="op">=</span> <span class="dv">1</span> to N:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    Generate y_i <span class="im">from</span> U(<span class="dv">0</span>, x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    Generate x<span class="op">*</span> <span class="im">from</span> U(Domain of x)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> f(x<span class="op">*</span>) <span class="op">&lt;</span> y</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        generate x<span class="op">*</span> <span class="im">from</span> U(<span class="bu">min</span>(x_&#123;i<span class="op">-</span><span class="dv">1</span>&#125;, x<span class="op">*</span>), <span class="bu">max</span>(x_&#123;i<span class="op">+</span><span class="dv">1</span>&#125;, x<span class="op">*</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    x_i <span class="op">=</span> x<span class="op">*</span></span></code></pre></div>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2021-06-19T17:54:14.888Z" itemprop="dateUpdated">6月 20, 2021 01:54</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="https://ayllenzhang.github.io">
            <img src="/img/mokuroo.png" alt="Ayllen Zhang">
            Ayllen Zhang
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MCMC/" rel="tag">MCMC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notes/" rel="tag">notes</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ayllenzhang.github.io/2019/07/mcmc-notes/&title=《Notes about MCMC and Sampling》 — Ayllen's Neverland&pic=https://ayllenzhang.github.io/img/mokuroo.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ayllenzhang.github.io/2019/07/mcmc-notes/&title=《Notes about MCMC and Sampling》 — Ayllen's Neverland&source=It all starts with a question:

How to sample from a given distribution?

" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ayllenzhang.github.io/2019/07/mcmc-notes/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Notes about MCMC and Sampling》 — Ayllen's Neverland&url=https://ayllenzhang.github.io/2019/07/mcmc-notes/&via=https://ayllenzhang.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ayllenzhang.github.io/2019/07/mcmc-notes/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/08/fuji-mnt/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">摇曳露营的巡礼之旅，富士山行记</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/07/proba-note/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Probability statistics notes</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment v" id="vcomments"></div>
    <!-- <div class="comment" id="comment"></div> -->
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
    <!-- <script src="//t1.aixinxi.net/o_1c3n4pim01nl3jg91b6l1kjtkvsa.js"></script> -->
    <!-- <script src="/js/Valine.min.js"></script> -->
    <!-- <script src="https://cdnjs.cat.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
    <script src="//cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            av: AV,
            // el: '#comments',
            el: '#vcomments',
            emoticon_url: 'https://abelsu7.top/alu', //表情图片网址
            emoticon_list: ["赞一个.png","坐等.png","长草.png","阴暗.png","邪恶.png","小眼睛.png","想一想.png","献黄瓜.png","献花.png","喜极而泣.png","无语.png","无所谓.png","无奈.png","投降.png","深思.png","期待.png","狂汗.png","蜡烛.png","看不见.png","惊喜.png","击掌.png","欢呼.png","得意.png","不出所料.png","观察.png"],//表情图片文件名
            // notify: 'false' == 'false',
            // verify: 'false' == 'false',
            // notify: 'false',
            // verify: 'false',
            notify: false,
            verify: false,
            appId: "cFer952Ja6DQ1O1yE5bT2hDU-gzGzoHsz",
            appKey: "MzfFmkudIEwjkIT0SfkW0fCm",
            avatar: "mp",
            placeholder: "Comments are welcome",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->









    <section class="comments" id="comments">
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
        <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
        <script>
            var id = location.pathname
            if (location.pathname.length > 50) {
              id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
            }
            const gitalk = new Gitalk({
              clientID: '',
              clientSecret: '',
              repo: 'yiyayamaya.github.io',
              owner: 'yiyayamaya',
              admin: ['yiyayamaya'],
              id: id,      // Ensure uniqueness and length less than 50
              title: document.title.split('|')[0],
              distractionFreeMode: false  // Facebook-like distraction free mode
            })
            gitalk.render('gitalk-container')
        </script>
    </section>



</article>



</div>

        <footer class="footer">
    <div class="top">
        

            <p>
                
                    <span>
                        <a href="/atom.xml" target="_blank" class="rss" title="rss">
                            <i class="icon icon-lg icon-rss"></i>
                        </a>
                    </span>
                    
                        <span>
                            博客内容遵循 <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a>
                        </span>
            </p>
    </div>
    <div class="bottom">
        <p>
            <span>
                Ayllen Zhang &copy;
                    
                        2018 -
                            
                                2021
            </span>
            <span>
                
                    <a href="http://beian.miit.gov.cn/" target="_blank">
                        京ICP备18044497号-1
                    </a>
                    <br>
                    
                        Power by
                        <a href="http://hexo.io/" target="_blank">Hexo</a> Theme
                        <a href="https://github.com/abelsu7/hexo-theme-indigo-plus" target="_blank">indigo plus</a>
                        <p>Hosted by <a href="https://pages.github.com" target="_blank" style="font-weight: bold">Github Pages</a></p>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>
<a href="javascript:;" id="gobottom" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-comments"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ayllenzhang.github.io/2019/07/mcmc-notes/&title=《Notes about MCMC and Sampling》 — Ayllen's Neverland&pic=https://ayllenzhang.github.io/img/mokuroo.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ayllenzhang.github.io/2019/07/mcmc-notes/&title=《Notes about MCMC and Sampling》 — Ayllen's Neverland&source=It all starts with a question:

How to sample from a given distribution?

" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ayllenzhang.github.io/2019/07/mcmc-notes/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Notes about MCMC and Sampling》 — Ayllen's Neverland&url=https://ayllenzhang.github.io/2019/07/mcmc-notes/&via=https://ayllenzhang.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ayllenzhang.github.io/2019/07/mcmc-notes/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aQY7jMAwEwPn/p7PXBbKJuynPApZKJyNxbJUCEBSpn594vN7G359/uuf9/k/P/PTJzQMDA+OxjOT1r3K8Pz+5bt+LgYFxGuNTBJsF1jaMJs+5mDMGBgbG10fnIThnY2BgYKwwvk8oCanJMzEwMDBmm9ickX+7noZiYGCcwMir7v//+lf6GxgYGI9irJT7Z63NZIHqWWFgYGzNyANcWzi7C5bPBwMDY1fGSqjNU8mlNU5+i4GBcQBjtnVcaQzkE41CNgYGxjGMZEuZBNN2aZIU8yLSYmBgHMCYTb1tSbYJX1Hgw8DA2JoxK7G1RzSSX83ur3NYDAyMxzJmzcU2gZtNsQjKGBgYBzPasJs3Ptsy3MXyYWBgbMqY5Y95cFzJVb8vyj/+BwwMjE0ZeTqYJ4JJe+DewhwGBsbejJWjEvnrkwZDi7nob2BgYGzHSFKx9iDFSkmublpgYGBszZiliXmJrS2u/eJhCwwMjIcz8k3mrLi/kiYW4RsDA+MYRj6V9dZmEsqLJcbAwDiAsT6JPGTPUsCLhgEGBsbBjLYj2objttcanRzBwMDYiPEqR16gb7esSbj/SMXAwNiakY+VEtustZBcD0+9YWBgPJCRvKDd4g5Xa7RAGBgY5zCScNm2G/NgfdteHAMDA6Ms9CeFvPXDGRgYGBhtWb9NFleOlN0QcDEwMB7FSDax+Ua33dDOSm8YGBjnMPKt40pRrJ1E3h7AwMDYmvEHHoGJh2qt08cAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.jsdelivr.net/npm/node-waves@0.7.6/src/js/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<!-- <script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script> -->
<!-- <script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script> -->






<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '...Standby';
            clearTimeout(titleTime);
        } else {
            document.title = 'Neverland';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>


<script src="/js/prism.min.js?v=1.7.2"></script>
<script src="/js/prism-vim.min.js?v=1.7.2"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
